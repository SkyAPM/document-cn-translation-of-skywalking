(window.webpackJsonp=window.webpackJsonp||[]).push([[320],{301:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),a("p",[t._v("插件测试框架旨在验证插件的功能和兼容状态。由于有数十个插件和数百个版本需要验证，因此无法手动进行。\n测试框架使用基于容器的技术堆栈，需要一组安装了代理程序的真实服务，然后运行测试模拟OAP后端以检查从代理程序发送的分段数据。\n主仓库中维护的每个插件都需要相应的测试用例，并且还与受支持的列表文档中的版本匹配。")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),a("p",[t._v("以以下测试项目为例")]),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),a("p",[t._v("Take the following test project as a good example")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/apache/skywalking/tree/master/test/plugin/scenarios/spring-4.3.x-scenario",target:"_blank",rel:"noopener noreferrer"}},[t._v("spring-4.3.x-scenario"),a("OutboundLink")],1)])]),t._v(" "),t._m(10),t._v(" "),a("p",[t._v("该测试用例是一个独立的Maven项目，需要将其打包为war tar 文件或zip文件，具体取决于所选的基本镜像。此外，还需要两个外部可访问端点，主要是两个URL。")]),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._m(14),t._v(" "),t._m(15),t._m(16),t._v(" "),a("p",[t._v("每个测试用例都需要以下文件。")]),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._m(27),t._v(" "),a("p",[t._v("例如在官方文档中，健康检查是")]),t._v(" "),t._m(28),a("p",[t._v("在这里，应该写成")]),t._v(" "),t._m(29),t._m(30),t._v(" "),t._m(31),t._v(" "),t._m(32),t._v(" "),t._m(33),t._v(" "),t._m(34),t._v(" "),t._m(35),t._v(" "),t._m(36),t._v(" "),t._m(37),t._v(" "),t._m(38),t._v(" "),t._m(39),t._v(" "),t._m(40),t._m(41),t._v(" "),t._m(42),t._v(" "),t._m(43),t._v(" "),t._m(44),t._m(45),t._v(" "),a("p",[t._v("SegmentRef的验证描述")]),t._v(" "),t._m(46),t._v(" "),t._m(47),t._v(" "),t._m(48),t._v(" "),t._m(49),t._v(" "),t._m(50),t._v(" "),a("p",[t._v("测试框架默认情况下会将服务名称设置为测试用例文件夹名称，但是在某些情况下，需要多个测试项目才能以不同的服务代码运行，可以像以下示例一样显式设置它。")]),t._v(" "),a("p",[t._v("示例")]),t._v(" "),t._m(51),t._m(52),t._v(" "),t._m(53),t._v(" "),t._m(54),t._v(" "),t._m(55),t._v(" "),t._m(56),t._v(" "),a("p",[t._v("我们提供了原型和脚本，使创建项目更加容易。它创建了一个完整的测试用例项目。\n这样我们只需要关注用例。首先，我们可以关注以下命令来获取有关脚本的用法。")]),t._v(" "),t._m(57),t._v(" "),t._m(58),t._v(" "),t._m(59),t._v(" "),t._m(60),t._m(61),t._v(" "),a("p",[t._v("心跳服务旨在检查服务可用状态。该服务是一个简单的HTTP服务，返回200表示目标服务已准备就绪。\n然后，流量生成器将访问进入服务并验证预期数据。用户应考虑使用此服务来检测诸如相关服务是否已准备就绪，尤其是在相关服务是数据库或集群时。")]),t._v(" "),t._m(62),t._v(" "),t._m(63),t._v(" "),t._m(64),t._v(" "),a("p",[t._v("我们正在使用HttpClient插件来展示如何写入期望的数据.")]),t._v(" "),a("p",[t._v("测试有两个要点")]),t._v(" "),t._m(65),t._v(" "),t._m(66),t._m(67),t._v(" "),a("p",[t._v("通过遵循HttpClient用例的流程，应该创建两个追踪段。")]),t._v(" "),t._m(68),t._v(" "),t._m(69),a("p",[t._v("由于Tomcat插件是SkyWalking的默认插件，因此在SegmentA中有两个跨度")]),t._v(" "),t._m(70),t._v(" "),a("p",[t._v("SegmentA跨度列表应如下")]),t._v(" "),t._m(71),a("p",[t._v("SegmentB应该只有一个Tomcat跨度，但应包含指向SegmentA的Ref。")]),t._v(" "),a("p",[t._v("SegmentB跨度列表应如下")]),t._v(" "),t._m(72),t._m(73),t._v(" "),a("p",[t._v("首先，测试用例项目可以成功编译，具有正确的项目结构并且可以部署。\n开发人员应该测试启动脚本是否可以在Linux / MacOS中运行，并且 入口服务/健康检查服务 能够提供响应。")]),t._v(" "),a("p",[t._v("您可以使用以下命令运行测试")]),t._v(" "),t._m(74),t._m(75),t._v(" "),t._m(76),t._v(" "),t._m(77),t._v(" "),t._m(78),t._v(" "),t._m(79)])}),[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"插件自动测试框架"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#插件自动测试框架"}},[this._v("#")]),this._v(" 插件自动测试框架")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"环境要求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#环境要求"}},[this._v("#")]),this._v(" 环境要求")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("MacOS/Linux")]),this._v(" "),s("li",[this._v("jdk 8+")]),this._v(" "),s("li",[this._v("Docker")]),this._v(" "),s("li",[this._v("Docker Compose")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"用例库镜像简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用例库镜像简介"}},[this._v("#")]),this._v(" 用例库镜像简介")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("该测试框架提供了 "),s("code",[this._v("JVM-container")]),this._v(" 和 "),s("code",[this._v("Tomcat-container")]),this._v(" 基础镜像。您可以为您的测试用例选择合适的一个，如果其中一个合适，建议选择"),s("code",[this._v("JVM-container")]),this._v(" 。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"jvm容器镜像简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jvm容器镜像简介"}},[this._v("#")]),this._v(" JVM容器镜像简介")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("a",{attrs:{href:"../../../test/plugin/containers/jvm-container"}},[this._v("JVM-container")]),this._v(" 使用 "),s("code",[this._v("openjdk:8")]),this._v(" 作为基础镜像。\n必须使用“ mvn clean package”将测试用例项目打包为“ project-name.zip”，包括“ startup.sh”和uber jar。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("a",{attrs:{href:"../../../test/plugin/scenarios/sofarpc-scenario"}},[this._v("sofarpc-scenario")]),this._v("作为单个项目用例。")]),this._v(" "),s("li",[s("a",{attrs:{href:"../../../test/plugin/scenarios/webflux-scenario"}},[this._v("webflux-scenario")]),this._v(" 作为包括多个项目的用例。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"tomcat容器镜像简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tomcat容器镜像简介"}},[this._v("#")]),this._v(" Tomcat容器镜像简介")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[a("a",{attrs:{href:"../../../test/plugin/containers/tomcat-container"}},[t._v("Tomcat-container")]),t._v(" 使用 "),a("code",[t._v("tomcat:8.5.42-jdk8-openjdk")]),t._v(" 作为基础镜像。\n必须使用 "),a("code",[t._v("mvn package")]),t._v(" 将测试用例项目打包为 "),a("code",[t._v("project-name.war")]),t._v("。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"测试项目层次结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试项目层次结构"}},[this._v("#")]),this._v(" 测试项目层次结构")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("所有的测试用例代码都应该在"),s("code",[this._v("org.apache.skywalking.apm.testcase")]),this._v("包中，除非期望使用某些代码，否则这些类可以在"),s("code",[this._v("test.org.apache.skywalking.apm.testcase")]),this._v("包中。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("JVM容器测试项目层次结构")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("[plugin-scenario]\n    |- [bin]\n        |- startup.sh\n    |- [config]\n        |- expectedData.yaml\n    |- [src]\n        |- [main]\n            |- ...\n        |- [resource]\n            |- log4j2.xml\n    |- pom.xml\n    |- configuration.yaml\n    |- support-version.list\n\n[] = directory\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("Tomcat容器测试项目层次结构")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("[plugin-scenario]\n    |- [config]\n        |- expectedData.yaml\n    |- [src]\n        |- [main]\n            |- ...\n        |- [resource]\n            |- log4j2.xml\n        |- [webapp]\n            |- [WEB-INF]\n                |- web.xml\n    |- pom.xml\n    |- configuration.yaml\n    |- support-version.list\n\n[] = directory\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"测试用例配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试用例配置文件"}},[this._v("#")]),this._v(" 测试用例配置文件")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("文件名")]),t._v(" "),a("th",[t._v("内容描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v("configuration.yml")])]),t._v(" "),a("td",[t._v("声明基本的测试用例介绍, 包括, 用例名称, 入口端点，模式，依赖项。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("expectedData.yaml")])]),t._v(" "),a("td",[t._v("描述预期的追踪段数据。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("support-version.list")])]),t._v(" "),a("td",[t._v("列出此用例的目标版本。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("startup.sh")])]),t._v(" "),a("td",[t._v("仅仅在"),a("code",[t._v("JVM-container")]),t._v(" 中需要, 当使用"),a("code",[t._v("Tomcat-container")]),t._v("时不需要。")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("*")]),this._v(" "),s("code",[this._v("support-version.list")]),this._v(" 格式要求每一行是个单独版本。可以使用"),s("code",[this._v("＃")]),this._v("来注释该版本。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"configuration-yml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configuration-yml"}},[this._v("#")]),this._v(" configuration.yml")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("type")]),t._v(" "),a("td",[t._v("镜像类型, 可选 "),a("code",[t._v("jvm")]),t._v(" 或者 "),a("code",[t._v("tomcat")]),t._v("。必填。")])]),t._v(" "),a("tr",[a("td",[t._v("entryService")]),t._v(" "),a("td",[t._v("用于测试用例访问的入口端点(URL)。必填。 (HTTP Method: GET)")])]),t._v(" "),a("tr",[a("td",[t._v("healthCheck")]),t._v(" "),a("td",[t._v("用于测试用例健康检查的端点(URL)。必填。 (HTTP Method: HEAD)")])]),t._v(" "),a("tr",[a("td",[t._v("startScript")]),t._v(" "),a("td",[t._v("启动脚本的路径。仅在镜像类型为jvm("),a("code",[t._v("type: jvm")]),t._v(")时必填。")])]),t._v(" "),a("tr",[a("td",[t._v("framework")]),t._v(" "),a("td",[t._v("用例名称.")])]),t._v(" "),a("tr",[a("td",[t._v("runningMode")]),t._v(" "),a("td",[t._v("运行模式是否带有可选插件,可选, 默认"),a("code",[t._v("default")]),t._v(", "),a("code",[t._v("with_optional")]),t._v(", "),a("code",[t._v("with_bootstrap")])])]),t._v(" "),a("tr",[a("td",[t._v("withPlugins")]),t._v(" "),a("td",[t._v("插件选择规则。例:"),a("code",[t._v("apm-spring-annotation-plugin-*.jar")]),t._v("。当 "),a("code",[t._v("runningMode=with_optional")]),t._v(" 或 "),a("code",[t._v("runningMode=with_bootstrap")]),t._v("必填。")])]),t._v(" "),a("tr",[a("td",[t._v("environment")]),t._v(" "),a("td",[t._v("例如"),a("code",[t._v("docker-compose#environment")]),t._v(".")])]),t._v(" "),a("tr",[a("td",[t._v("depends_on")]),t._v(" "),a("td",[t._v("例如"),a("code",[t._v("docker-compose#depends_on")]),t._v(".")])]),t._v(" "),a("tr",[a("td",[t._v("dependencies")]),t._v(" "),a("td",[t._v("例如"),a("code",[t._v("docker-compose#services")]),t._v(", 支持"),a("code",[t._v("image、links、hostname、environment、depends_on")]),t._v("。")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("注意：仅当"),s("code",[this._v("dependencies")]),this._v("为空时，"),s("code",[this._v("docker-compose")]),this._v("才有效。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("runningMode")]),this._v("选项说明。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("选项")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("default")]),t._v(" "),a("td",[t._v("激活"),a("code",[t._v("plugin")]),t._v("文件夹中的所有插件，例如官方发行的插件。")])]),t._v(" "),a("tr",[a("td",[t._v("with_optional")]),t._v(" "),a("td",[t._v("激活"),a("code",[t._v("default")]),t._v("模式和"),a("code",[t._v("optional-plugin")]),t._v("文件夹里面的通过指定选择器指定的插件。")])]),t._v(" "),a("tr",[a("td",[t._v("with_bootstrap")]),t._v(" "),a("td",[t._v("激活"),a("code",[t._v("default")]),t._v("模式和"),a("code",[t._v("bootstrap-plugin")]),t._v("文件夹里面的通过指定选择器指定的插件。")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("with_optional/with_bootstrap 支持多个选择器,以"),s("code",[this._v(";")]),this._v("分割.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("文件格式")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("type:\nentryService:\nhealthCheck:\nstartScript:\nframework:\nrunningMode:\nwithPlugins:\nenvironment:\n  ...\ndepends_on:\n  ...\ndependencies:\n  service1:\n    image:\n    hostname:\n    expose:\n      ...\n    environment:\n      ...\n    depends_on:\n      ...\n    links:\n      ...\n    entrypoint:\n      ...\n    healthcheck:\n      ...\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("依赖项支持docker撰写"),s("code",[this._v("healthcheck")]),this._v("。但是格式略有不同。我们需要将-作为每个配置项的开头，并将其描述为字符串行。")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("healthcheck")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CMD"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"curl"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-f"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhost"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("interval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 1m30s\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("timeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 10s\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("retries")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("start_period")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 40s\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("healthcheck")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'test: ["CMD", "curl", "-f", "http://localhost"]\'')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"interval: 1m30s"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"timeout: 10s"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"retries: 3"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"start_period: 40s"')]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在某些情况下，需要依赖服务（主要是第三方服务器，例如SolrJ服务器）来保持与客户端库版本相同的版本，该库在pom中定义为"),s("code",[this._v("$ {test.framework.version}")]),this._v("。\n可以将"),s("code",[this._v("${CASE_SERVER_IMAGE_VERSION}")]),this._v("用作版本号，它将在测试中针对每个版本进行更改。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("不支持与资源相关的配置，例如卷，端口和ulimit。因为在测试场景中\n不需要将任何端口映射到主机VM，也无需安装任何文件夹。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("以以下测试用例可以作为参考")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("a",{attrs:{href:"../../../test/plugin/scenarios/dubbo-2.7.x-scenario/configuration.yml"}},[this._v("dubbo-2.7.x with JVM-container")])]),this._v(" "),s("li",[s("a",{attrs:{href:"../../../test/plugin/scenarios/jetty-scenario/configuration.yml"}},[this._v("jetty with JVM-container")])]),this._v(" "),s("li",[s("a",{attrs:{href:"../../../test/plugin/scenarios/gateway-2.1.x-scenario/configuration.yml"}},[this._v("gateway with runningMode")])]),this._v(" "),s("li",[s("a",{attrs:{href:"../../../test/plugin/scenarios/canal-scenario/configuration.yml"}},[this._v("canal with docker-compose")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"expecteddata-yaml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#expecteddata-yaml"}},[this._v("#")]),this._v(" expectedData.yaml")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("数字运算符")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("运算符")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("nq")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("!=")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("eq")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("==(默认情况下)")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("ge")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v(">=")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("gt")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v(">")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("字符串运算符")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("运算符")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("not null")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("不为空")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("null")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("空或者空字符串")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("code",[t._v("eq")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("等于(默认情况下)")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("细分目标描述格式")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("segmentItems")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("serviceName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" SERVICE_NAME(string)\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("segmentSize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" SEGMENT_SIZE(int)\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("segments")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("segmentId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" SEGMENT_ID(string)\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spans")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("属性")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("serviceName")]),t._v(" "),a("td",[t._v("服务名称。")])]),t._v(" "),a("tr",[a("td",[t._v("segmentSize")]),t._v(" "),a("td",[t._v("预期的目标数量。")])]),t._v(" "),a("tr",[a("td",[t._v("segmentId")]),t._v(" "),a("td",[t._v("链路ID。")])]),t._v(" "),a("tr",[a("td",[t._v("spans")]),t._v(" "),a("td",[t._v("追踪段跨度列表。遵循下一部分，以了解如何描述每个跨度。")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("跨度验证描述格式")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("注意")]),this._v("：跨度列表的顺序应遵循跨度完成时间的顺序。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[t._v("    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("operationName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" OPERATION_NAME(string)\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentSpanId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PARENT_SPAN_ID(int)\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spanId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" SPAN_ID(int)\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" START_TIME(int)\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("endTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" END_TIME(int)\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("isError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("IS_ERROR(string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" false)\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spanLayer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("SPAN_LAYER(string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" DB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" RPC_FRAMEWORK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" HTTP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MQ"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" CACHE)\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spanType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("SPAN_TYPE(string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Exit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Entry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Local)\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("componentId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" COMPONENT_ID(int)\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("tags")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TAG_KEY(string)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TAG_VALUE(string)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("logs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" LOG_KEY(string)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" LOG_VALUE(string)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("peer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PEER(string)\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("refs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("traceId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TRACE_ID(string)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentTraceSegmentId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PARENT_TRACE_SEGMENT_ID(string)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentSpanId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PARENT_SPAN_ID(int)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentService")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PARENT_SERVICE(string)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentServiceInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PARENT_SERVICE_INSTANCE(string)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentEndpoint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PARENT_ENDPOINT_NAME(string)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networkAddress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" NETWORK_ADDRESS(string)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("refType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("REF_TYPE(string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" CrossProcess"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" CrossThread)\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("属性")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("operationName")]),t._v(" "),a("td",[t._v("跨度操作名称。")])]),t._v(" "),a("tr",[a("td",[t._v("parentSpanId")]),t._v(" "),a("td",[t._v("父跨度ID。 "),a("strong",[t._v("注意")]),t._v(": 第一个跨度的父跨度ID应该为-1。")])]),t._v(" "),a("tr",[a("td",[t._v("spanId")]),t._v(" "),a("td",[t._v("跨度ID. "),a("strong",[t._v("注意")]),t._v(", 从0开始。")])]),t._v(" "),a("tr",[a("td",[t._v("startTime")]),t._v(" "),a("td",[t._v("跨度开始时间。 无法获得准确的时间，非0。")])]),t._v(" "),a("tr",[a("td",[t._v("endTime")]),t._v(" "),a("td",[t._v("跨度结束时间。无法获得准确的时间，非0。")])]),t._v(" "),a("tr",[a("td",[t._v("isError")]),t._v(" "),a("td",[t._v("跨度状态, true 或者 false.")])]),t._v(" "),a("tr",[a("td",[t._v("componentId")]),t._v(" "),a("td",[t._v("插件的组件ID。")])]),t._v(" "),a("tr",[a("td",[t._v("tags")]),t._v(" "),a("td",[t._v("跨度的标签列表。 "),a("strong",[t._v("注意")]),t._v(",保持与插件编码相同的顺序。")])]),t._v(" "),a("tr",[a("td",[t._v("logs")]),t._v(" "),a("td",[t._v("跨度的日志列表。 "),a("strong",[t._v("注意")]),t._v(",保持与插件编码相同的顺序。")])]),t._v(" "),a("tr",[a("td",[t._v("SpanLayer")]),t._v(" "),a("td",[t._v("可选项, DB, RPC_FRAMEWORK, HTTP, MQ, CACHE.")])]),t._v(" "),a("tr",[a("td",[t._v("SpanType")]),t._v(" "),a("td",[t._v("跨度类型, 可选项, Exit、Entry 或 Local.")])]),t._v(" "),a("tr",[a("td",[t._v("peer")]),t._v(" "),a("td",[t._v("远端网络地址, 大部分情况下是IP +端口。对于Exit跨度，这是必需的。")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("属性")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("traceId")]),t._v(" "),a("td",[t._v("链路ID")])]),t._v(" "),a("tr",[a("td",[t._v("parentTraceSegmentId")]),t._v(" "),a("td",[t._v("父追踪段ID，指向父追踪段中的追踪段ID。")])]),t._v(" "),a("tr",[a("td",[t._v("parentSpanId")]),t._v(" "),a("td",[t._v("父跨度ID, 指向父追踪段中跨度的跨度ID。")])]),t._v(" "),a("tr",[a("td",[t._v("parentService")]),t._v(" "),a("td",[t._v("父/下游服务的名称。")])]),t._v(" "),a("tr",[a("td",[t._v("parentServiceInstance")]),t._v(" "),a("td",[t._v("父/下游服务实例的名称。")])]),t._v(" "),a("tr",[a("td",[t._v("parentEndpoint")]),t._v(" "),a("td",[t._v("父/下游服务的端点。")])]),t._v(" "),a("tr",[a("td",[t._v("networkAddress")]),t._v(" "),a("td",[t._v("父出口跨度的远端网络地址。")])]),t._v(" "),a("tr",[a("td",[t._v("refType")]),t._v(" "),a("td",[t._v("引用类型, 可选项, 跨进程 或 跨线程.")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"startup-sh"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#startup-sh"}},[this._v("#")]),this._v(" startup.sh")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("该脚本提供了基于JVM的服务的起点，其中大多数以带有一些变量的"),s("code",[this._v("java -jar")]),this._v("开始。 Shell中提供了以下系统环境变量。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("变量")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("agent_opts")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("选择代理插件，请检查插件文档中的详细信息或此PR中添加的相同选项。")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("SCENARIO_NAME")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("服务名称。默认与用例文件夹名称相同")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("SCENARIO_VERSION")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("版本")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("SCENARIO_ENTRY_SERVICE")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("进入此服务的入口URL")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("SCENARIO_HEALTH_CHECK_URL")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("健康检查的URL")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[s("code",[this._v("${agent_opts}")]),this._v(" 必须添加到你的 "),s("code",[this._v("java -jar")]),this._v(" 命令行, 其中包括测试框架注入的参数, 和\n保证探针能被加载。 所有其他参数应在之后 "),s("code",[this._v("${agent_opts}")]),this._v("添加.")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("home")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$(cd "'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dirname")]),t._v(" $0"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v('"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("pwd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\n\njava -jar '),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${agent_opts}")]),t._v(' "')]),t._v("-Dskywalking.agent.service_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("jettyserver-scenario"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('" '),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${home}")]),t._v("/../libs/jettyserver-scenario.jar &\nsleep 1\n\njava -jar "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${agent_opts}")]),t._v(' "')]),t._v("-Dskywalking.agent.service_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v('jettyclient-scenario"  '),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${home}")]),t._v("/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/libs/jettyclient-scenario.jar "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("\n\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("仅在确实需要时设置此选项或使用其他SkyWalking选项。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("以以下测试用例为例")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("a",{attrs:{href:"../../../test/plugin/scenarios/undertow-scenario/bin/startup.sh"}},[this._v("undertow")])]),this._v(" "),s("li",[s("a",{attrs:{href:"../../../test/plugin/scenarios/webflux-scenario/webflux-dist/bin/startup.sh"}},[this._v("webflux")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"最佳实践"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[this._v("#")]),this._v(" 最佳实践")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"如何使用原型创建测试用例项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何使用原型创建测试用例项目"}},[this._v("#")]),this._v(" 如何使用原型创建测试用例项目")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("bash ${SKYWALKING_HOME}/test/plugin/generator.sh")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("然后运行并在"),s("code",[this._v("./scenarios")]),this._v("中生成一个以"),s("code",[this._v("scenario_name")]),this._v("的项目。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"推荐pom"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#推荐pom"}},[this._v("#")]),this._v(" 推荐Pom")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[t._v("    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("properties")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 在pom中提供和使用此属性. --\x3e")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 此版本应与库版本匹配, --\x3e")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 在这种情况下，http组件库版本为4.3. --\x3e")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("test.framework.version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("4.3"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("test.framework.version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("properties")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependencies")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.apache.httpcomponents"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("httpclient"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("${test.framework.version}"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        ...\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependencies")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 将程序包的最终名称设置为与测试用例文件夹的大小写相同. --\x3e")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("finalName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("httpclient-4.3.x-scenario"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("finalName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        ....\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"如何实现心跳服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何实现心跳服务"}},[this._v("#")]),this._v(" 如何实现心跳服务")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("请注意，由于可以完整或部分跟踪心跳服务，因此, "),s("code",[this._v("expectedData.yaml")]),this._v("中的"),s("code",[this._v("segmentSize")]),this._v("(追踪段数量)应当使用 "),s("code",[this._v("ge")]),this._v("作为操作符,\n并且不要在预期的追踪段数据中包含心跳服务的追踪段。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"编写预期数据的示例过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编写预期数据的示例过程"}},[this._v("#")]),this._v(" 编写预期数据的示例过程")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("预期数据文件, "),s("code",[this._v("expectedData.yaml")]),this._v(", 包含 "),s("code",[this._v("SegmentItems")]),this._v(".")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("是否创建HttpClient span。")]),this._v(" "),s("li",[this._v("ContextCarrier是否正确创建，并在进程之间传播。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("+-------------+         +------------------+            +-------------------------+\n|   Browser   |         |  Case Servlet    |            | ContextPropagateServlet |\n|             |         |                  |            |                         |\n+-----|-------+         +---------|--------+            +------------|------------+\n      |                           |                                  |\n      |                           |                                  |\n      |       WebHttp            +-+                                 |\n      +------------------------\x3e |-|         HttpClient             +-+\n      |                          |--------------------------------\x3e |-|\n      |                          |-|                                |-|\n      |                          |-|                                |-|\n      |                          |-| <--------------------------------|\n      |                          |-|                                +-+\n      | <--------------------------|                                 |\n      |                          +-+                                 |\n      |                           |                                  |\n      |                           |                                  |\n      |                           |                                  |\n      |                           |                                  |\n      +                           +                                  +\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"segmentitems"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#segmentitems"}},[this._v("#")]),this._v(" segmentItems")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("一段代表 用例Servlet 访问。我们将其命名为"),s("code",[this._v("SegmentA")]),this._v("。")]),this._v(" "),s("li",[this._v("一段代表ContextPropagateServlet访问。我们将其命名为"),s("code",[this._v("SegmentB")]),this._v("。")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("segmentItems")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("serviceName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" httpclient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("case\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("segmentSize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ge 2 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Could have more than one health check segments, because, the dependency is not standby.")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("Tomcat 入口跨度(entry span)")]),this._v(" "),s("li",[this._v("HttpClient 出口跨度(exit span)")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[t._v("    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("segmentId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" not null\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spans")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("operationName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /httpclient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("case/case/context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("propagate\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentSpanId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spanId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nq 0\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("endTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nq 0\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("isError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spanLayer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Http\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spanType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Exit\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("componentId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" eq 2\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("tags")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://127.0.0.1:8080/httpclient-case/case/context-propagate'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http.method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" GET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("logs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("peer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 127.0.0.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("operationName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /httpclient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("case/case/httpclient\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentSpanId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("-1")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spanId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nq 0\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("endTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nq 0\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spanLayer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Http\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("isError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spanType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Entry\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("componentId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("tags")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:{SERVER_OUTPUT_PORT}/httpclient-case/case/httpclient'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http.method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" GET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("logs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("peer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token null important"}},[t._v("null")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("segmentId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" not null\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spans")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("operationName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /httpclient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("case/case/context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("propagate\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentSpanId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("-1")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spanId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("tags")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://127.0.0.1:8080/httpclient-case/case/context-propagate'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http.method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" GET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("logs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("startTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nq 0\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("endTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nq 0\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spanLayer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Http\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("isError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spanType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Entry\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("componentId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("peer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token null important"}},[t._v("null")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("refs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentEndpoint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /httpclient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("case/case/httpclient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networkAddress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost:8080'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("refType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" CrossProcess"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentSpanId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentTraceSegmentId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" not null"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentServiceInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" not null"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("parentService")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" not null"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("traceId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" not null"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"本地测试和提交"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#本地测试和提交"}},[this._v("#")]),this._v(" 本地测试和提交")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${SKYWALKING_HOME}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v(" ./test/plugin/run.sh -f "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${scenario_name}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[a("strong",[t._v("注意")]),t._v("，如果 "),a("code",[t._v("./apm-sniffer")]),t._v(" 中的代码被改变, 不管是因为您的更改还是git更新，\n请重新编译 "),a("code",[t._v("skywalking-agent")]),t._v("模块。因为测试框架将使用现有的 "),a("code",[t._v("skywalking-agent")]),t._v(" 文件夹,\n而不是每次都重新编译它。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("使用 "),s("code",[this._v("${SKYWALKING_HOME}/test/plugin/run.sh -h")]),this._v(" 了解更多命令选项。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("如果本地测试通过，则可以将其添加到 "),s("code",[this._v(".github/workflows/plugins-test.<n>.yaml")]),this._v(" 文件, 它将驱动在官方SkyWalking存储库的Github Actions上运行的测试。\n根据您的插件名称, 请按字母顺序将测试用例添加到"),s("code",[this._v(".github/workflows/plugins-test.<n>.yaml")]),this._v(" 文件中。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("每个测试用例都是一个Github Actions作业(job)。请使用 "),a("code",[t._v("<scenario name> + <version range> + (<supported version count>)")]),t._v("作为作业(job)的 "),a("code",[t._v("title")]),t._v(", 并且方案目录作为作业的"),a("code",[t._v("name")]),t._v(",\n通常，您只需要确定要在文件（"),a("code",[t._v("plugins-test。<n> .yaml")]),t._v("）中添加测试用例，并简单地在其中添加一行（如下所示），以现有用例为示例。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("PluginsTest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Plugin\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runs-on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ubuntu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18.04")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("timeout-minutes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("90")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("strategy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("fail-fast")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("matrix")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("case")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ...")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<your case name>'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<PluginName, i.e. Spring> (<Supported Version Count, i.e 12>)'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# <<== 按字母顺序插入一行")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ...")]),t._v("\n")])])])}],!1,null,null,null);s.default=n.exports}}]);