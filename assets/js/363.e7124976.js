(window.webpackJsonp=window.webpackJsonp||[]).push([[363],{184:function(e,t,r){"use strict";r.r(t);var n=r(0),a=Object(n.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"content"},[e._m(0),e._v(" "),r("p",[e._v("Envoy "),r("a",{attrs:{href:"https://www.envoyproxy.io/docs/envoy/latest/api-v2/service/accesslog/v2/als.proto",target:"_blank",rel:"noopener noreferrer"}},[e._v("ALS(access log service)"),r("OutboundLink")],1),e._v(" 提供了 RPC 路由的完整日志, 包括 HTTP 和 TCP.")]),e._v(" "),r("p",[e._v("方案由 "),r("a",{attrs:{href:"https://github.com/wu-sheng",target:"_blank",rel:"noopener noreferrer"}},[e._v("Sheng Wu"),r("OutboundLink")],1),e._v(", "),r("a",{attrs:{href:"https://github.com/hanahmily",target:"_blank",rel:"noopener noreferrer"}},[e._v("Hongtao Gao"),r("OutboundLink")],1),e._v(", "),r("a",{attrs:{href:"https://github.com/lizan",target:"_blank",rel:"noopener noreferrer"}},[e._v("Lizan Zhou"),r("OutboundLink")],1),e._v(" 和 "),r("a",{attrs:{href:"https://github.com/dio",target:"_blank",rel:"noopener noreferrer"}},[e._v("Dhi Aurrahman"),r("OutboundLink")],1),e._v(" 在 2019/5/17 启动实现，并在 "),r("a",{attrs:{href:"https://kccncosschn19eng.sched.com/event/NroB/observability-in-service-mesh-powered-by-envoy-and-apache-skywalking-sheng-wu-lizan-zhou-tetrate",target:"_blank",rel:"noopener noreferrer"}},[e._v("KubeCon China 2019"),r("OutboundLink")],1),e._v(" 提出。这里有 "),r("a",{attrs:{href:"https://www.youtube.com/watch?v=tERm39ju9ew",target:"_blank",rel:"noopener noreferrer"}},[e._v("视频"),r("OutboundLink")],1),e._v(" 记录。")]),e._v(" "),r("p",[e._v("SkyWalking 是全球范围内第一个介绍这种基于 ALS 的解决方案的开源项目。这为网格服务提供了一种低负载但有相同可观测性的新方法。")]),e._v(" "),r("p",[e._v("你需要以下三步来开启 ALS:")]),e._v(" "),r("ol",[r("li",[e._v("在 Istio 中打开 Envoy 访问日志服务，详见 "),r("a",{attrs:{href:"https://istio.io/docs/reference/config/istio.mesh.v1alpha1/#ProxyConfig",target:"_blank",rel:"noopener noreferrer"}},[e._v("ProxyConfig 中启用 "),r("strong",[e._v("envoyAccessLogService")]),r("OutboundLink")],1)]),e._v(" "),r("li",[e._v("打开 SkyWalking "),r("router-link",{attrs:{to:"./../backend/backend-receivers.html"}},[e._v("Envoy 接收器")]),e._v(".")],1),e._v(" "),r("li",[e._v("激活 ALS k8s-mesh 分析，配置如下")])]),e._v(" "),e._m(1),e._m(2),e._v(" "),r("p",[e._v("提示，只有当 Envoy 受 Istio 控制时才可以使用，并且在 K8S 环境下。 OAP 需要所有 pods 都有读 K8S API 服务的权限。")])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",{attrs:{id:"通过-als-观测服务网格"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#通过-als-观测服务网格"}},[this._v("#")]),this._v(" 通过 ALS 观测服务网格")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"language-yaml extra-class"},[r("pre",{pre:!0,attrs:{class:"language-yaml"}},[r("code",[r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("envoy-metric")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("default")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("alsHTTPAnalysis")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"k8s-mesh"')]),e._v("\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("多个值使用 "),t("code",[this._v(",")]),this._v(" 分隔")])}],!1,null,null,null);t.default=a.exports}}]);